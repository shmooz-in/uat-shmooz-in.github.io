"use strict";(self.webpackChunkshmooz=self.webpackChunkshmooz||[]).push([[1265],{91265:function(e,n,t){t.r(n),t.d(n,{default:function(){return fe}});var a=t(93433),r=t(4942),l=t(29439),i=t(45987),s=t(1413),o=t(47313),u=t(9506),c=t(82294),d=t(65280),v=t(24193),p=t(85281),h=t(79429),m=t(16031),x=t.n(m),f=t(2135),b=t(3463),g=[b.Ry().shape({}),b.Ry().shape({})],Z=t(19860),j=function(e){return{stepper:{padding:e.spacing(3,0,5)},buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative"},buttonProgress:{position:"absolute",top:"50%",left:"50%"}}},y=t(33497),k=t(48384),S=t(90573),P=t(9019),_=t(61113),C=t(63318),w=t(24631),T=t(46417),A=["errorText"];function V(e){e.errorText;var n=(0,i.Z)(e,A),t=(0,h.U$)(e),a=(0,l.Z)(t,2),r=a[0],o=a[1];return(0,T.jsx)(w.Z,(0,s.Z)((0,s.Z)({type:"text",error:o.touched&&o.error&&!0,helperText:function(){var e=(0,m.at)(o,"touched","error"),n=(0,l.Z)(e,2),t=n[0],a=n[1];return t&&a?a:null}()},r),n))}var E=t(15480),W=t(1550),F=t(83929),O=t(44758),N=["label"];function z(e){var n=e.label,t=(0,i.Z)(e,N),a=(0,h.U$)(e),r=(0,l.Z)(a,3),o=r[0],u=r[1],c=r[2].setValue,d=function(){var e=(0,m.at)(u,"touched","error"),n=(0,l.Z)(e,2),t=n[0],a=n[1];return t&&a?(0,T.jsx)(E.Z,{children:a}):null};return(0,T.jsxs)(W.Z,(0,s.Z)((0,s.Z)({},t),{},{children:[(0,T.jsx)(F.Z,{value:o.checked,checked:o.checked,control:(0,T.jsx)(O.Z,(0,s.Z)((0,s.Z)({},o),{},{onChange:function(e){c(e.target.checked)}})),label:n}),(0,T.jsx)(d,{})]}))}var B=t(51405),R=["data"];function I(e){var n=e.data,t=(0,i.Z)(e,R),a=(0,h.U$)(e),r=(0,l.Z)(a,2),o=r[0],u=r[1],c=o.value,d=(0,m.at)(u,"touched","error"),v=(0,l.Z)(d,2),p=v[0],x=v[1],f=p&&x&&!0;return(0,T.jsx)(w.Z,(0,s.Z)((0,s.Z)((0,s.Z)({select:!0,error:u.touched&&u.error&&!0,helperText:f?(0,T.jsx)(E.Z,{children:x}):null},o),t),{},{value:c||"",children:n.map((function(e,n){return(0,T.jsx)(B.Z,{value:e.value,children:e.label},n)}))}))}I.defaultProps={data:[]};var G=I;t(30411);var U=t(81628),D=["label","value"];function M(e){e.label;var n=e.value,t=(0,i.Z)(e,D),a=(0,h.U$)(e),r=(0,l.Z)(a,3),s=(r[0],r[1],r[2].setValue);return(0,T.jsx)(U.Z,{attachments:n?[n]:[],setFieldValue:function(e,n){s(n||[])},fieldName:t.name})}var $=function(e){var n,t,a,r=e.setting,i=null!==r&&void 0!==r&&r.details?null===(n=JSON.parse(null===r||void 0===r||null===(t=r.details)||void 0===t?void 0:t.replace(/\n/g,"")))||void 0===n?void 0:n.options:[],s=[];Array.isArray(i)&&i.length>0?s=i.map((function(e,n){return{value:n,label:e}})):i&&(null===(a=Object.keys(i))||void 0===a?void 0:a.length)>0&&Object.keys(i).forEach((function(e){s.push({value:e,label:i[e]})}));var o=(0,h.U$)(r.key),u=(0,l.Z)(o,3),c=u[0],d=(u[1],u[2].setValue);switch(r.type){case"text":return(0,T.jsx)(V,{name:r.key,label:r.display_name,fullWidth:!0});case"select_dropdown":return(0,T.jsx)(G,{name:r.key,label:r.display_name,data:s,fullWidth:!0});case"text_area":return(0,T.jsx)(V,{name:r.key,label:r.display_name,multiline:!0,fullWidth:!0});case"image":return(0,T.jsxs)(P.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:4,children:(0,T.jsx)(_.Z,{variant:"body2",children:r.display_name})}),(0,T.jsxs)(P.ZP,{item:!0,xs:12,sm:8,children:[(0,T.jsx)(M,{name:r.key,label:r.display_name,value:r.value}),";"]})]});case"checkbox":return(0,T.jsx)(z,{name:r.key,label:r.display_name,type:"checkbox"});case"double":return(0,T.jsx)(V,{name:r.key,label:r.display_name,type:"number",fullWidth:!0});case"double_range":return(0,T.jsxs)(P.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:6,children:(0,T.jsx)(_.Z,{variant:"caption",children:r.display_name})}),(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:6,children:(0,T.jsx)(C.ZP,{name:r.key,value:c.value,onChange:function(e,n){d(n)},valueLabelDisplay:"auto",disableSwap:!0,marks:[{value:0,label:"0%"},{value:100,label:"100%"}]})})]});default:return(0,T.jsx)("div",{children:"Not Found"})}};function H(e){var n=e.settings,t=e.tabName,r=o.useMemo((function(){return(0,a.Z)(n).sort((function(e,n){return e.order-n.order}))}),[n]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(_.Z,{variant:"h6",gutterBottom:!0,children:t}),(0,T.jsx)(P.ZP,{container:!0,spacing:3,children:r.map((function(e){return(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:6,children:(0,T.jsx)($,{setting:e})},e.key)}))})]})}var J=t(15861),L=t(64687),K=t.n(L),q=t(50301),Q=t(94469),X=t(33604),Y=t(96467),ee=t(41727),ne=t(4117),te=t(43394),ae=t(97101),re=t(12401),le=t(66182),ie=t(85554),se=t(5866),oe=(t(70816),[{value:"text",label:"Text"},{value:"select_dropdown",label:"Select"},{value:"text_area",label:"Text Area"},{value:"image",label:"Image"},{value:"checkbox",label:"Checkbox"},{value:"double",label:"Double"},{value:"double_range",label:"Range"}]),ue=(0,o.forwardRef)((function(e,n){return(0,T.jsx)(q.Z,(0,s.Z)({direction:"left",ref:n},e))})),ce=b.Ry().shape({});function de(e){var n,t,a,r=e.setting,l=null!==r&&void 0!==r&&r.details?null===(n=JSON.parse(null===r||void 0===r||null===(t=r.details)||void 0===t?void 0:t.replace(/\n/g,"")))||void 0===n?void 0:n.options:[],i=[];switch(Array.isArray(l)&&l.length>0?i=l.map((function(e,n){return{value:n,label:e}})):l&&(null===(a=Object.keys(l))||void 0===a?void 0:a.length)>0&&Object.keys(l).forEach((function(e){i.push({value:e,label:l[e]})})),r.type){case"text":return(0,T.jsx)(V,{name:"value",label:"Value",fullWidth:!0});case"select_dropdown":return(0,T.jsx)(G,{name:"value",label:"Value",data:i,fullWidth:!0});case"text_area":return(0,T.jsx)(V,{name:"value",label:"Value",multiline:!0,fullWidth:!0});case"image":return(0,T.jsxs)(P.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:4,children:(0,T.jsx)(_.Z,{variant:"body2",children:r.display_name})}),(0,T.jsxs)(P.ZP,{item:!0,xs:12,sm:8,children:[(0,T.jsx)(M,{name:"value",label:"Value",value:r.value}),";"]})]});case"checkbox":return(0,T.jsx)(z,{name:"value",label:"Value",type:"checkbox"});case"double":return(0,T.jsx)(V,{name:"value",label:"Value",type:"number",fullWidth:!0});case"double_range":return(0,T.jsxs)(P.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:6,children:(0,T.jsx)(_.Z,{variant:"caption",children:r.display_name})}),(0,T.jsx)(P.ZP,{item:!0,xs:12,sm:6,children:(0,T.jsx)(C.ZP,{defaultValue:[20,37],valueLabelDisplay:"auto",disableSwap:!0,marks:[{value:0,label:"0%"},{value:100,label:"100%"}]})})]});default:return(0,T.jsx)("div",{children:"Not Found"})}}var ve=function(e){var n=e.open,t=e.handleCloseDialog,a=e.editingAdminSetting,r=void 0===a?{}:a,l=(0,ie.I0)(),i=function(e){t(),l((0,se.ss)({open:!0,message:"Admin Setting Updated successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1}))},o=function(){var e=(0,J.Z)(K().mark((function e(n,t,a,r,l){return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t,!0,!0);case 2:l(t,n[t].join(", "));case 3:case"end":return e.stop()}}),e)})));return function(n,t,a,r,l){return e.apply(this,arguments)}}(),c=function(e){var n=e.setFieldTouched,t=void 0===n?null:n,a=e.setErrors,r=void 0===a?null:a,l=e.setFieldError,i=void 0===l?null:l;return function(){var e=(0,J.Z)(K().mark((function e(n){var a,l,s,u,c;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===n||void 0===n||null===(a=n.data)||void 0===a||!a.errors){e.next=5;break}u=null===n||void 0===n||null===(s=n.data)||void 0===s?void 0:s.errors,Object.keys(u).forEach((function(e){o(u,e,t,r,i)})),e.next=9;break;case 5:if(null===n||void 0===n||null===(l=n.data)||void 0===l||!l.message){e.next=9;break}return e.next=8,t("submit",!0,!0);case 8:i("submit",null===n||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()};return(0,T.jsx)(Q.Z,{open:n,TransitionComponent:ue,keepMounted:!0,onClose:t,sx:{"&>div:nth-of-type(3)":{justifyContent:"flex-end","&>div":{m:0,borderRadius:"0px",maxWidth:450,maxHeight:"100%"}}},children:n&&(0,T.jsx)(h.J9,{initialValues:(0,s.Z)({submit:null,display_name:"",key:"",group:"",order:1,details:""},r),enableReinitialize:!0,validationSchema:ce,onSubmit:function(){var e=(0,J.Z)(K().mark((function e(n,t){var a,r,o,u,d;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.setErrors,t.setStatus,t.setSubmitting,r=t.setFieldTouched,o=t.setFieldError,u=(0,s.Z)({},n),console.log(n),d={setFieldTouched:r,setErrors:a,setFieldError:o};try{u.id?(u._method="put",l((0,k.im)(u,i,c(d)))):u.id||l((0,k.m$)(u,i,c(d)))}catch(v){l((0,se.ss)({open:!0,message:"An Error Occured",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"error"},close:!1})),console.error(v)}case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),children:function(e){var n,a=e.errors,l=(e.setFieldValue,e.handleBlur),i=e.handleChange,s=e.handleSubmit,o=(e.isSubmitting,e.touched),c=e.values;return(0,T.jsx)("form",{noValidate:!0,onSubmit:s,id:"edit-admin",children:(0,T.jsxs)(te._,{dateAdapter:ae.H,children:[(0,T.jsx)(X.Z,{children:"Create Setting for Group - ".concat(r.group)}),(0,T.jsx)(Y.Z,{children:(0,T.jsxs)(P.ZP,{container:!0,spacing:re.dv,sx:{mt:.25},children:[(0,T.jsx)(P.ZP,{item:!0,xs:12,children:(0,T.jsx)(w.Z,{id:"adminSettings-group",fullWidth:!0,label:"Group",name:"group",disabled:!0,value:c.group,onBlur:l,onChange:i,error:Boolean(o.group&&a.group),helperText:o.group&&a.group})}),(0,T.jsx)(P.ZP,{item:!0,xs:12,children:(0,T.jsx)(w.Z,{id:"adminSettings-display-name",fullWidth:!0,label:"Display Name",name:"display_name",value:c.display_name,onBlur:l,onChange:i,error:Boolean(o.display_name&&a.display_name),helperText:o.display_name&&a.display_name})}),(0,T.jsx)(P.ZP,{item:!0,xs:12,children:(0,T.jsx)(w.Z,{id:"adminSettings-key",fullWidth:!0,label:"Key",name:"key",value:c.key,onBlur:l,onChange:i,error:Boolean(o.key&&a.key),helperText:o.key&&a.key,InputProps:{startAdornment:(0,T.jsx)(ee.Z,{position:"start",children:null===(n=c.group)||void 0===n?void 0:n.toLowerCase()})}})}),(0,T.jsx)(P.ZP,{item:!0,md:6,xs:12,children:(0,T.jsx)(w.Z,{id:"standard-select-type",name:"type",select:!0,label:"Select Type*",value:c.type,fullWidth:!0,onBlur:l,onChange:i,children:oe.map((function(e){return(0,T.jsx)(B.Z,{value:e.value,children:e.label},e.value)}))})}),(0,T.jsx)(P.ZP,{item:!0,md:6,xs:12,children:(0,T.jsx)(w.Z,{id:"standard-order",name:"order",type:"number",label:"Setting Order*",value:c.order,fullWidth:!0,inputProps:{min:0},onBlur:l,onChange:i})}),(0,T.jsx)(P.ZP,{item:!0,xs:12,children:(null===c||void 0===c?void 0:c.type)&&(0,T.jsx)(de,{setting:c})})]})}),(0,T.jsxs)(ne.Z,{children:[a.submit&&(0,T.jsx)(u.Z,{sx:{ml:3,flex:1},children:(0,T.jsx)(E.Z,{error:!0,children:a.submit})}),(0,T.jsx)(le.Z,{children:(0,T.jsx)(v.Z,{variant:"text",color:"error",onClick:t,children:"Close"})})]}),(0,T.jsx)(u.Z,{sx:{mt:2}})]})})}})})},pe=["children","value","index"];function he(e){var n={};return function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";x().forEach(t,(function(t,r){!x().isObject(t)||t instanceof File||Array.isArray(t)?Array.isArray(t)?n["".concat(a).concat(r)]=t.join("-"):n["".concat(a).concat(r)]=t:e(t,"".concat(a).concat(r,"-"))}))}(e),n}function me(e){var n=e.children,t=e.value,a=e.index,r=(0,i.Z)(e,pe);return(0,T.jsx)("div",(0,s.Z)((0,s.Z)({role:"tabpanel",hidden:t!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),{},{children:t===a&&(0,T.jsx)(u.Z,{sx:{p:0},children:n})}))}var xe=function(e){var n=e.settingGroups,t=e.setActiveTab,r=o.useState((0,a.Z)(n.keys())[0]),i=(0,l.Z)(r,2),u=i[0],v=i[1],p=(0,o.useMemo)((function(){return(0,a.Z)(n.keys())}),[n]),m=(0,h.u6)().values;return(0,o.useEffect)((function(){t(u)}),[u]),(0,T.jsx)(y.Z,{title:"",children:(0,T.jsxs)("div",{children:[(0,T.jsx)(c.Z,{value:u,indicatorColor:"primary",onChange:function(e,n){console.log(m),v(n)},sx:{mb:3,minHeight:"auto","& button":{minWidth:100},"& a":{minHeight:"auto",minWidth:10,py:1.5,px:1,mr:2.25,color:"grey.600"},"& a.Mui-selected":{color:"primary.main"}},"aria-label":"simple tabs example",variant:"scrollable",children:p.map((function(e){return(0,T.jsx)(d.Z,(0,s.Z)({component:f.rU,to:"#",value:e,label:e},{key:n=e,id:"simple-tab-".concat(n),"aria-controls":"simple-tabpanel-".concat(n)}));var n}))}),p.map((function(e,t){return(0,T.jsx)(me,{value:u,index:e,children:(0,T.jsx)(H,{settings:null===n||void 0===n?void 0:n.get(e),tabName:e})},t)}))]})})};var fe=function(){var e=(0,Z.Z)(),n=j(e),t=(0,o.useState)(""),a=(0,l.Z)(t,2),i=a[0],u=a[1],c=(0,o.useState)({}),d=(0,l.Z)(c,2),m=d[0],f=d[1],b=(0,o.useState)(new Map),y=(0,l.Z)(b,2),P=y[0],_=y[1],C=g[0],w=o.useState(!1),A=(0,l.Z)(w,2),V=A[0],E=A[1],W=(0,o.useState)(null),F=(0,l.Z)(W,2),O=F[0],N=F[1],z=(0,S.I0)();(0,o.useEffect)((function(){z((0,k.Gw)())}),[z]);var B=(0,S.v9)((function(e){return e.adminSettings})).settings;(0,o.useEffect)((function(){if((null===B||void 0===B?void 0:B.length)>0){var e=function(e){var n={},t=new Map;return e.forEach((function(e){var a,i=t.get(e.group);i?i.add(e):t.set(e.group,new Set([e])),e.key=null===(a=e.key)||void 0===a?void 0:a.replace("-",".");var o=e.key.split("."),u=(0,l.Z)(o,2),c=u[0],d=u[1],v=e.value;"double_range"===e.type&&(v=e.value.split("-").map((function(e){return+e}))),n=(0,s.Z)((0,s.Z)({},n),{},(0,r.Z)({},c,(0,s.Z)((0,s.Z)({},n[c]),{},(0,r.Z)({},d,v))))})),console.log(t),console.log(n),{initialValues:n,settingGroups:t}}(JSON.parse(JSON.stringify(B)));f(e.initialValues),_(e.settingGroups)}}),[B]);var R=(0,h.TA)({initialValues:m,enableReinitialize:!0,validationSchema:C,onSubmit:function(e,n){var t=he(e);console.log(t);var a=he(R.initialValues);console.log(a);var r=function(e,n){var t=(0,s.Z)({},e),a=Object.keys(t),r=a.filter((function(e){return t[e]!==n[e]}));return a.forEach((function(e){r.includes(e)||delete t[e]})),t}(t,a);console.log(r),x().isEmpty(r)||z((0,k.uW)(r,(function(){n.setTouched({}),n.setSubmitting(!1)}),(function(){n.setTouched({}),n.setSubmitting(!1)})))}}),I=R.isSubmitting;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ve,{open:V,editingAdminSetting:O,handleCloseDialog:function(){E(!1)}}),(0,T.jsx)(h.Hy,{value:R,children:(0,T.jsxs)(h.l0,{id:"checkoutForm",children:[P.size>0&&(0,T.jsx)(xe,{settingGroups:P,setActiveTab:u}),(0,T.jsxs)("div",{style:n.buttons,children:[(0,T.jsx)("div",{style:n.wrapper,children:(0,T.jsx)(v.Z,{color:"primary",sx:n.button,onClick:function(){return R.resetForm()},children:"Reset Changes"})}),(0,T.jsxs)("div",{style:n.wrapper,children:[(0,T.jsx)(v.Z,{disabled:!0,onClick:function(){return function(){var e;N({group:i,order:((null===(e=P.get(i))||void 0===e?void 0:e.size)||0)+1}),E(!0)}()},variant:"contained",color:"primary",sx:n.button,children:"Create New ".concat(i," Setting")}),I&&(0,T.jsx)(p.Z,{size:24,sx:n.buttonProgress})]}),(0,T.jsxs)("div",{style:n.wrapper,children:[(0,T.jsx)(v.Z,{disabled:I||!R.dirty,type:"submit",variant:"contained",color:"primary",sx:n.button,children:"Save Changes"}),I&&(0,T.jsx)(p.Z,{size:24,sx:n.buttonProgress})]})]})]})})]})}}}]);