"use strict";(self.webpackChunkshmooz=self.webpackChunkshmooz||[]).push([[1265],{91265:function(e,n,t){t.r(n),t.d(n,{default:function(){return ke}});var r=t(93433),a=t(4942),l=t(29439),i=t(45987),s=t(1413),o=t(47313),u=t(9506),c=t(82294),d=t(65280),v=t(24193),p=t(85281),h=t(79429),m=t(68537),x=t.n(m),f=t(45522),b=t.n(f),g=t(91845),Z=t.n(g),j=t(2135),y=t(3463),k=[y.Ry().shape({}),y.Ry().shape({})],S=t(19860),P=function(e){return{stepper:{padding:e.spacing(3,0,5)},buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)},wrapper:{margin:e.spacing(1),position:"relative"},buttonProgress:{position:"absolute",top:"50%",left:"50%"}}},_=t(33497),C=t(48384),w=t(12754),T=t(9019),A=t(61113),V=t(63318),W=t(36180),E=t.n(W),F=t(24631),O=t(46417),N=["errorText"];function z(e){e.errorText;var n=(0,i.Z)(e,N),t=(0,h.U$)(e),r=(0,l.Z)(t,2),a=r[0],o=r[1];return(0,O.jsx)(F.Z,(0,s.Z)((0,s.Z)({type:"text",error:o.touched&&o.error&&!0,helperText:function(){var e=E()(o,"touched","error"),n=(0,l.Z)(e,2),t=n[0],r=n[1];return t&&r?r:null}()},a),n))}var B=t(15480),R=t(1550),I=t(83929),G=t(44758),U=["label"];function D(e){var n=e.label,t=(0,i.Z)(e,U),r=(0,h.U$)(e),a=(0,l.Z)(r,3),o=a[0],u=a[1],c=a[2].setValue,d=function(){var e=E()(u,"touched","error"),n=(0,l.Z)(e,2),t=n[0],r=n[1];return t&&r?(0,O.jsx)(B.Z,{children:r}):null};return(0,O.jsxs)(R.Z,(0,s.Z)((0,s.Z)({},t),{},{children:[(0,O.jsx)(I.Z,{value:o.checked,checked:o.checked,control:(0,O.jsx)(G.Z,(0,s.Z)((0,s.Z)({},o),{},{onChange:function(e){c(e.target.checked)}})),label:n}),(0,O.jsx)(d,{})]}))}var M=t(51405),$=["data"];function H(e){var n=e.data,t=(0,i.Z)(e,$),r=(0,h.U$)(e),a=(0,l.Z)(r,2),o=a[0],u=a[1],c=o.value,d=E()(u,"touched","error"),v=(0,l.Z)(d,2),p=v[0],m=v[1],x=p&&m&&!0;return(0,O.jsx)(F.Z,(0,s.Z)((0,s.Z)((0,s.Z)({select:!0,error:u.touched&&u.error&&!0,helperText:x?(0,O.jsx)(B.Z,{children:m}):null},o),t),{},{value:c||"",children:n.map((function(e,n){return(0,O.jsx)(M.Z,{value:e.value,children:e.label},n)}))}))}H.defaultProps={data:[]};var J=H;t(30411);var L=t(81628),K=["label","value"];function q(e){e.label;var n=e.value,t=(0,i.Z)(e,K),r=(0,h.U$)(e),a=(0,l.Z)(r,3),s=(a[0],a[1],a[2].setValue);return(0,O.jsx)(L.Z,{attachments:n?[n]:[],setFieldValue:function(e,n){s(n||[])},fieldName:t.name})}var Q=function(e){var n,t,r,a=e.setting,i=null!==a&&void 0!==a&&a.details?null===(n=JSON.parse(null===a||void 0===a||null===(t=a.details)||void 0===t?void 0:t.replace(/\n/g,"")))||void 0===n?void 0:n.options:[],s=[];Array.isArray(i)&&i.length>0?s=i.map((function(e,n){return{value:n,label:e}})):i&&(null===(r=Object.keys(i))||void 0===r?void 0:r.length)>0&&Object.keys(i).forEach((function(e){s.push({value:e,label:i[e]})}));var o=(0,h.U$)(a.key),u=(0,l.Z)(o,3),c=u[0],d=(u[1],u[2].setValue);switch(a.type){case"text":return(0,O.jsx)(z,{name:a.key,label:a.display_name,fullWidth:!0});case"select_dropdown":return(0,O.jsx)(J,{name:a.key,label:a.display_name,data:s,fullWidth:!0});case"text_area":return(0,O.jsx)(z,{name:a.key,label:a.display_name,multiline:!0,fullWidth:!0});case"image":return(0,O.jsxs)(T.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:4,children:(0,O.jsx)(A.Z,{variant:"body2",children:a.display_name})}),(0,O.jsxs)(T.ZP,{item:!0,xs:12,sm:8,children:[(0,O.jsx)(q,{name:a.key,label:a.display_name,value:a.value}),";"]})]});case"checkbox":return(0,O.jsx)(D,{name:a.key,label:a.display_name,type:"checkbox"});case"double":return(0,O.jsx)(z,{name:a.key,label:a.display_name,type:"number",fullWidth:!0});case"double_range":return(0,O.jsxs)(T.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:6,children:(0,O.jsx)(A.Z,{variant:"caption",children:a.display_name})}),(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:6,children:(0,O.jsx)(V.ZP,{name:a.key,value:c.value,onChange:function(e,n){d(n)},valueLabelDisplay:"auto",disableSwap:!0,marks:[{value:0,label:"0%"},{value:100,label:"100%"}]})})]});default:return(0,O.jsx)("div",{children:"Not Found"})}};function X(e){var n=e.settings,t=e.tabName,a=o.useMemo((function(){return(0,r.Z)(n).sort((function(e,n){return e.order-n.order}))}),[n]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(A.Z,{variant:"h6",gutterBottom:!0,children:t}),(0,O.jsx)(T.ZP,{container:!0,spacing:3,children:a.map((function(e){return(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:6,children:(0,O.jsx)(Q,{setting:e})},e.key)}))})]})}var Y=t(15861),ee=t(64687),ne=t.n(ee),te=t(50301),re=t(94469),ae=t(33604),le=t(96467),ie=t(41727),se=t(4117),oe=t(43394),ue=t(97101),ce=t(12401),de=t(66182),ve=t(85554),pe=t(5866),he=(t(70816),[{value:"text",label:"Text"},{value:"select_dropdown",label:"Select"},{value:"text_area",label:"Text Area"},{value:"image",label:"Image"},{value:"checkbox",label:"Checkbox"},{value:"double",label:"Double"},{value:"double_range",label:"Range"}]),me=(0,o.forwardRef)((function(e,n){return(0,O.jsx)(te.Z,(0,s.Z)({direction:"left",ref:n},e))})),xe=y.Ry().shape({});function fe(e){var n,t,r,a=e.setting,l=null!==a&&void 0!==a&&a.details?null===(n=JSON.parse(null===a||void 0===a||null===(t=a.details)||void 0===t?void 0:t.replace(/\n/g,"")))||void 0===n?void 0:n.options:[],i=[];switch(Array.isArray(l)&&l.length>0?i=l.map((function(e,n){return{value:n,label:e}})):l&&(null===(r=Object.keys(l))||void 0===r?void 0:r.length)>0&&Object.keys(l).forEach((function(e){i.push({value:e,label:l[e]})})),a.type){case"text":return(0,O.jsx)(z,{name:"value",label:"Value",fullWidth:!0});case"select_dropdown":return(0,O.jsx)(J,{name:"value",label:"Value",data:i,fullWidth:!0});case"text_area":return(0,O.jsx)(z,{name:"value",label:"Value",multiline:!0,fullWidth:!0});case"image":return(0,O.jsxs)(T.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:4,children:(0,O.jsx)(A.Z,{variant:"body2",children:a.display_name})}),(0,O.jsxs)(T.ZP,{item:!0,xs:12,sm:8,children:[(0,O.jsx)(q,{name:"value",label:"Value",value:a.value}),";"]})]});case"checkbox":return(0,O.jsx)(D,{name:"value",label:"Value",type:"checkbox"});case"double":return(0,O.jsx)(z,{name:"value",label:"Value",type:"number",fullWidth:!0});case"double_range":return(0,O.jsxs)(T.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:6,children:(0,O.jsx)(A.Z,{variant:"caption",children:a.display_name})}),(0,O.jsx)(T.ZP,{item:!0,xs:12,sm:6,children:(0,O.jsx)(V.ZP,{defaultValue:[20,37],valueLabelDisplay:"auto",disableSwap:!0,marks:[{value:0,label:"0%"},{value:100,label:"100%"}]})})]});default:return(0,O.jsx)("div",{children:"Not Found"})}}var be=function(e){var n=e.open,t=e.handleCloseDialog,r=e.editingAdminSetting,a=void 0===r?{}:r,l=(0,ve.I0)(),i=function(e){t(),l((0,pe.ss)({open:!0,message:"Admin Setting Updated successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1}))},o=function(){var e=(0,Y.Z)(ne().mark((function e(n,t,r,a,l){return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,!0,!0);case 2:l(t,n[t].join(", "));case 3:case"end":return e.stop()}}),e)})));return function(n,t,r,a,l){return e.apply(this,arguments)}}(),c=function(e){var n=e.setFieldTouched,t=void 0===n?null:n,r=e.setErrors,a=void 0===r?null:r,l=e.setFieldError,i=void 0===l?null:l;return function(){var e=(0,Y.Z)(ne().mark((function e(n){var r,l,s,u,c;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===n||void 0===n||null===(r=n.data)||void 0===r||!r.errors){e.next=5;break}u=null===n||void 0===n||null===(s=n.data)||void 0===s?void 0:s.errors,Object.keys(u).forEach((function(e){o(u,e,t,a,i)})),e.next=9;break;case 5:if(null===n||void 0===n||null===(l=n.data)||void 0===l||!l.message){e.next=9;break}return e.next=8,t("submit",!0,!0);case 8:i("submit",null===n||void 0===n||null===(c=n.data)||void 0===c?void 0:c.message);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()};return(0,O.jsx)(re.Z,{open:n,TransitionComponent:me,keepMounted:!0,onClose:t,sx:{"&>div:nth-of-type(3)":{justifyContent:"flex-end","&>div":{m:0,borderRadius:"0px",maxWidth:450,maxHeight:"100%"}}},children:n&&(0,O.jsx)(h.J9,{initialValues:(0,s.Z)({submit:null,display_name:"",key:"",group:"",order:1,details:""},a),enableReinitialize:!0,validationSchema:xe,onSubmit:function(){var e=(0,Y.Z)(ne().mark((function e(n,t){var r,a,o,u,d;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.setErrors,t.setStatus,t.setSubmitting,a=t.setFieldTouched,o=t.setFieldError,u=(0,s.Z)({},n),console.log(n),d={setFieldTouched:a,setErrors:r,setFieldError:o};try{u.id?(u._method="put",l((0,C.im)(u,i,c(d)))):u.id||l((0,C.m$)(u,i,c(d)))}catch(v){l((0,pe.ss)({open:!0,message:"An Error Occured",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"error"},close:!1})),console.error(v)}case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),children:function(e){var n,r=e.errors,l=(e.setFieldValue,e.handleBlur),i=e.handleChange,s=e.handleSubmit,o=(e.isSubmitting,e.touched),c=e.values;return(0,O.jsx)("form",{noValidate:!0,onSubmit:s,id:"edit-admin",children:(0,O.jsxs)(oe._,{dateAdapter:ue.H,children:[(0,O.jsx)(ae.Z,{children:"Create Setting for Group - ".concat(a.group)}),(0,O.jsx)(le.Z,{children:(0,O.jsxs)(T.ZP,{container:!0,spacing:ce.dv,sx:{mt:.25},children:[(0,O.jsx)(T.ZP,{item:!0,xs:12,children:(0,O.jsx)(F.Z,{id:"adminSettings-group",fullWidth:!0,label:"Group",name:"group",disabled:!0,value:c.group,onBlur:l,onChange:i,error:Boolean(o.group&&r.group),helperText:o.group&&r.group})}),(0,O.jsx)(T.ZP,{item:!0,xs:12,children:(0,O.jsx)(F.Z,{id:"adminSettings-display-name",fullWidth:!0,label:"Display Name",name:"display_name",value:c.display_name,onBlur:l,onChange:i,error:Boolean(o.display_name&&r.display_name),helperText:o.display_name&&r.display_name})}),(0,O.jsx)(T.ZP,{item:!0,xs:12,children:(0,O.jsx)(F.Z,{id:"adminSettings-key",fullWidth:!0,label:"Key",name:"key",value:c.key,onBlur:l,onChange:i,error:Boolean(o.key&&r.key),helperText:o.key&&r.key,InputProps:{startAdornment:(0,O.jsx)(ie.Z,{position:"start",children:null===(n=c.group)||void 0===n?void 0:n.toLowerCase()})}})}),(0,O.jsx)(T.ZP,{item:!0,md:6,xs:12,children:(0,O.jsx)(F.Z,{id:"standard-select-type",name:"type",select:!0,label:"Select Type*",value:c.type,fullWidth:!0,onBlur:l,onChange:i,children:he.map((function(e){return(0,O.jsx)(M.Z,{value:e.value,children:e.label},e.value)}))})}),(0,O.jsx)(T.ZP,{item:!0,md:6,xs:12,children:(0,O.jsx)(F.Z,{id:"standard-order",name:"order",type:"number",label:"Setting Order*",value:c.order,fullWidth:!0,inputProps:{min:0},onBlur:l,onChange:i})}),(0,O.jsx)(T.ZP,{item:!0,xs:12,children:(null===c||void 0===c?void 0:c.type)&&(0,O.jsx)(fe,{setting:c})})]})}),(0,O.jsxs)(se.Z,{children:[r.submit&&(0,O.jsx)(u.Z,{sx:{ml:3,flex:1},children:(0,O.jsx)(B.Z,{error:!0,children:r.submit})}),(0,O.jsx)(de.Z,{children:(0,O.jsx)(v.Z,{variant:"text",color:"error",onClick:t,children:"Close"})})]}),(0,O.jsx)(u.Z,{sx:{mt:2}})]})})}})})},ge=["children","value","index"];function Ze(e){var n={};return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";x()(t,(function(t,a){!Z()(t)||t instanceof File||Array.isArray(t)?Array.isArray(t)?n["".concat(r).concat(a)]=t.join("-"):n["".concat(r).concat(a)]=t:e(t,"".concat(r).concat(a,"-"))}))}(e),n}function je(e){var n=e.children,t=e.value,r=e.index,a=(0,i.Z)(e,ge);return(0,O.jsx)("div",(0,s.Z)((0,s.Z)({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},a),{},{children:t===r&&(0,O.jsx)(u.Z,{sx:{p:0},children:n})}))}var ye=function(e){var n=e.settingGroups,t=e.setActiveTab,a=o.useState((0,r.Z)(n.keys())[0]),i=(0,l.Z)(a,2),u=i[0],v=i[1],p=(0,o.useMemo)((function(){return(0,r.Z)(n.keys())}),[n]),m=(0,h.u6)().values;return(0,o.useEffect)((function(){t(u)}),[u]),(0,O.jsx)(_.Z,{title:"",children:(0,O.jsxs)("div",{children:[(0,O.jsx)(c.Z,{value:u,indicatorColor:"primary",onChange:function(e,n){console.log(m),v(n)},sx:{mb:3,minHeight:"auto","& button":{minWidth:100},"& a":{minHeight:"auto",minWidth:10,py:1.5,px:1,mr:2.25,color:"grey.600"},"& a.Mui-selected":{color:"primary.main"}},"aria-label":"simple tabs example",variant:"scrollable",children:p.map((function(e){return(0,O.jsx)(d.Z,(0,s.Z)({component:j.rU,to:"#",value:e,label:e},{key:n=e,id:"simple-tab-".concat(n),"aria-controls":"simple-tabpanel-".concat(n)}));var n}))}),p.map((function(e,t){return(0,O.jsx)(je,{value:u,index:e,children:(0,O.jsx)(X,{settings:null===n||void 0===n?void 0:n.get(e),tabName:e})},t)}))]})})};var ke=function(){var e=(0,S.Z)(),n=P(e),t=(0,o.useState)(""),r=(0,l.Z)(t,2),i=r[0],u=r[1],c=(0,o.useState)({}),d=(0,l.Z)(c,2),m=d[0],x=d[1],f=(0,o.useState)(new Map),g=(0,l.Z)(f,2),Z=g[0],j=g[1],y=k[0],_=o.useState(!1),T=(0,l.Z)(_,2),A=T[0],V=T[1],W=(0,o.useState)(null),E=(0,l.Z)(W,2),F=E[0],N=E[1],z=(0,w.I0)();(0,o.useEffect)((function(){z((0,C.Gw)())}),[z]);var B=(0,w.v9)((function(e){return e.adminSettings})).settings;(0,o.useEffect)((function(){if((null===B||void 0===B?void 0:B.length)>0){var e=function(e){var n={},t=new Map;return e.forEach((function(e){var r,i=t.get(e.group);i?i.add(e):t.set(e.group,new Set([e])),e.key=null===(r=e.key)||void 0===r?void 0:r.replace("-",".");var o=e.key.split("."),u=(0,l.Z)(o,2),c=u[0],d=u[1],v=e.value;"double_range"===e.type&&(v=e.value.split("-").map((function(e){return+e}))),n=(0,s.Z)((0,s.Z)({},n),{},(0,a.Z)({},c,(0,s.Z)((0,s.Z)({},n[c]),{},(0,a.Z)({},d,v))))})),console.log(t),console.log(n),{initialValues:n,settingGroups:t}}(JSON.parse(JSON.stringify(B)));x(e.initialValues),j(e.settingGroups)}}),[B]);var R=(0,h.TA)({initialValues:m,enableReinitialize:!0,validationSchema:y,onSubmit:function(e,n){var t=Ze(e);console.log(t);var r=Ze(R.initialValues);console.log(r);var a=function(e,n){var t=(0,s.Z)({},e),r=Object.keys(t),a=r.filter((function(e){return t[e]!==n[e]}));return r.forEach((function(e){a.includes(e)||delete t[e]})),t}(t,r);console.log(a),b()(a)||z((0,C.uW)(a,(function(){n.setTouched({}),n.setSubmitting(!1)}),(function(){n.setTouched({}),n.setSubmitting(!1)})))}}),I=R.isSubmitting;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(be,{open:A,editingAdminSetting:F,handleCloseDialog:function(){V(!1)}}),(0,O.jsx)(h.Hy,{value:R,children:(0,O.jsxs)(h.l0,{id:"checkoutForm",children:[Z.size>0&&(0,O.jsx)(ye,{settingGroups:Z,setActiveTab:u}),(0,O.jsxs)("div",{style:n.buttons,children:[(0,O.jsx)("div",{style:n.wrapper,children:(0,O.jsx)(v.Z,{color:"primary",sx:n.button,onClick:function(){return R.resetForm()},children:"Reset Changes"})}),(0,O.jsxs)("div",{style:n.wrapper,children:[(0,O.jsx)(v.Z,{disabled:!0,onClick:function(){return function(){var e;N({group:i,order:((null===(e=Z.get(i))||void 0===e?void 0:e.size)||0)+1}),V(!0)}()},variant:"contained",color:"primary",sx:n.button,children:"Create New ".concat(i," Setting")}),I&&(0,O.jsx)(p.Z,{size:24,sx:n.buttonProgress})]}),(0,O.jsxs)("div",{style:n.wrapper,children:[(0,O.jsx)(v.Z,{disabled:I||!R.dirty,type:"submit",variant:"contained",color:"primary",sx:n.button,children:"Save Changes"}),I&&(0,O.jsx)(p.Z,{size:24,sx:n.buttonProgress})]})]})]})})]})}}}]);